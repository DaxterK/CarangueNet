<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FakeNet Carangueju</title>
  <style>
    body, html { margin:0; padding:0; font-family:'MS Sans Serif', sans-serif; background:#a0d8d0; overflow-x:hidden; height:100%; }
    #welcomeScreen { width:100%; height:100%; background:#f0f0f0; display:flex; justify-content:center; align-items:center; flex-direction:column; }
    #welcomeScreen input, #welcomeScreen button { margin:5px; padding:10px; font-size:16px; }
    #desktop { width:100%; height:100%; position:relative; display:none; overflow-y:auto; }
    #taskbar { position:absolute; bottom:0; left:0; width:100%; height:30px; background:#666; display:flex; align-items:center; padding:0 10px; z-index:1000; }
    #userInfo { display:flex; align-items:center; color:#fff; }
    #userInfo span { margin-right:10px; }
    #userInfo button { padding:5px 10px; background:#aaa; border:none; cursor:pointer; border-radius:3px; }
    #clock { color:#fff; font-family:'Courier New', monospace; font-size:12px; margin-left:auto; }
    .toast { background:#f0d888; padding:5px; margin:5px 0; border:1px solid #ccc; border-radius:3px; font-size:12px; color:#000; animation: fadeout 2s forwards; }
    #popup { display:none; position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); background:#fff; padding:20px; border:2px solid #666; border-radius:5px; z-index:2000; box-shadow:0 0 10px rgba(0,0,0,0.5); }
    #popup p { margin:0 0 15px 0; }
    #popup button { padding:5px 10px; margin-right:10px; }
    @keyframes fadeout { 0%{opacity:1;} 90%{opacity:1;} 100%{opacity:0;} }
    @media (max-width: 480px) {
      #welcomeScreen { padding:10px; }
      #welcomeScreen input, #welcomeScreen button { width:100%; box-sizing:border-box; }
      #taskbar { height:40px; font-size:14px; padding:5px; }
      #userInfo button { padding:3px 8px; font-size:12px; }
      #popup { width:80%; }
    }
  </style>
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js';
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from 'https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js';
  </script>
</head>
<body>

<!-- Pantalla de bienvenida -->
<div id="welcomeScreen">
  <h1>Bienvenido a FakeNet Carangueju</h1>
  <div>
    <h3>Visitante</h3>
    <input type="text" id="visitorName" placeholder="Nombre visitante">
    <button onclick="enterAsVisitor()">Entrar como visitante</button>
  </div>
  <div>
    <h3>Usuario registrado</h3>
    <input type="text" id="userName" placeholder="Usuario">
    <input type="password" id="userPass" placeholder="Contrase帽a">
    <button onclick="loginUser()">Entrar / Registrar</button>
  </div>
  <div id="welcomeToast"></div>
</div>

<!-- Escritorio -->
<div id="desktop">
  <div id="taskbar"></div>
  <div id="popup">
    <p>驴Est谩s seguro de que quieres cerrar sesi贸n?</p>
    <button onclick="confirmLogout(true)">S铆</button>
    <button onclick="confirmLogout(false)">No</button>
  </div>
</div>

<script>
let currentUser = '';
let isVisitor = false;

const firebaseConfig = {
  // Reemplaza con tu config de Firebase
  apiKey: "TU_API_KEY",
  authDomain: "TU_PROJECT.firebaseapp.com",
  projectId: "TU_PROJECT",
  storageBucket: "TU_PROJECT.appspot.com",
  messagingSenderId: "TU_SENDER_ID",
  appId: "TU_APP_ID"
};
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

function showWelcomeToast(msg) {
  const container = document.getElementById('welcomeToast');
  const toast = document.createElement('div');
  toast.className = 'toast';
  toast.textContent = msg;
  container.appendChild(toast);
  setTimeout(() => toast.remove(), 2000);
}

function enterAsVisitor() {
  const name = document.getElementById('visitorName').value.trim();
  if (!name) { showWelcomeToast('Ingresa un nombre'); return; }
  currentUser = name + ' (Visitante)';
  isVisitor = true;
  startDesktop();
}

function loginUser() {
  const name = document.getElementById('userName').value.trim();
  const pass = document.getElementById('userPass').value.trim();
  if (!name || !pass) { showWelcomeToast('Usuario y contrase帽a requeridos'); return; }
  const email = name + '@carangueju.fake';
  signInWithEmailAndPassword(auth, email, pass)
    .then((userCredential) => {
      currentUser = name;
      isVisitor = false;
      startDesktop();
    })
    .catch((error) => {
      if (error.code === 'auth/user-not-found') {
        createUserWithEmailAndPassword(auth, email, pass)
          .then(() => {
            currentUser = name;
            isVisitor = false;
            startDesktop();
          })
          .catch(() => showWelcomeToast('Error al registrar'));
      } else {
        showWelcomeToast('Error: ' + error.message);
      }
    });
}

function confirmLogout(confirm) {
  const popup = document.getElementById('popup');
  popup.style.display = 'none';
  if (confirm) {
    logout();
  }
}

function logout() {
  if (isVisitor) {
    // Para visitantes, solo volver a login
    currentUser = '';
    isVisitor = false;
    document.getElementById('desktop').style.display = 'none';
    document.getElementById('welcomeScreen').style.display = 'flex';
    document.getElementById('taskbar').innerHTML = '';
    showWelcomeToast('Sesi贸n cerrada');
  } else {
    signOut(auth).then(() => {
      currentUser = '';
      isVisitor = false;
      document.getElementById('desktop').style.display = 'none';
      document.getElementById('welcomeScreen').style.display = 'flex';
      document.getElementById('taskbar').innerHTML = '';
      showWelcomeToast('Sesi贸n cerrada');
    }).catch((error) => {
      showWelcomeToast('Error al cerrar sesi贸n: ' + error.message);
    });
  }
}

function startDesktop() {
  document.getElementById('welcomeScreen').style.display = 'none';
  document.getElementById('desktop').style.display = 'block';
  initTaskbar();
  startClock();
}

function initTaskbar() {
  const taskbar = document.getElementById('taskbar');
  taskbar.innerHTML = '';

  const userInfo = document.createElement('div');
  userInfo.id = 'userInfo';
  userInfo.innerHTML = `<span>${currentUser}</span><button onclick="showPopup()">Cerrar sesi贸n</button>`;
  taskbar.appendChild(userInfo);

  const clock = document.createElement('div');
  clock.id = 'clock';
  taskbar.appendChild(clock);
}

function showPopup() {
  const popup = document.getElementById('popup');
  popup.style.display = 'block';
}

function startClock() {
  function updateClock() {
    const now = new Date();
    const hours = String(now.getHours()).padStart(2, '0');
    const minutes = String(now.getMinutes()).padStart(2, '0');
    const seconds = String(now.getSeconds()).padStart(2, '0');
    const date = String(now.getDate()).padStart(2, '0');
    const month = String(now.getMonth() + 1).padStart(2, '0');
    const year = now.getFullYear();
    const clock = document.getElementById('clock');
    if (clock) {
      clock.textContent = `${hours}:${minutes}:${seconds} ${date}/${month}/${year}`;
    }
  }
  updateClock();
  setInterval(updateClock, 1000);
}
</script>

</body>
</html>
```

---

### Correcci贸n del problema
- **Para visitantes**: A帽ad铆 una variable `isVisitor` para diferenciar. Si es visitante, `logout()` simplemente limpia y vuelve a login sin llamar a `signOut(auth)`, ya que no hay sesi贸n Firebase.
- **Para usuarios registrados**: Usa `signOut(auth)` para cerrar la sesi贸n real.
- **Pop-up**: El bot贸n "S铆" ahora llama a `confirmLogout(true)`, que oculta el pop-up y ejecuta `logout()`. El bot贸n "No" solo oculta el pop-up.

---

### Instrucciones
1. **Copia el c贸digo**: Selecciona todo, c贸pialo (Ctrl+C o Cmd+C).
2. **Sube a GitHub**: Edita `index.html` en [github.com/tu-username/CaranguejuNet](https://github.com/tu-username/CaranguejuNet), pega el c贸digo, y haz commit con mensaje "Ajustar cierre de sesi贸n para visitantes".
3. **Espera el deploy**: Netlify actualizar谩 en 1-2 minutos. Revisa [app.netlify.com](https://app.netlify.com) > Tu sitio > "Deploys".
4. **Configura Firebase**: Aseg煤rate de reemplazar el `firebaseConfig` con tus credenciales.

---

### Prueba y retroalimentaci贸n
- Inicia sesi贸n como visitante (ej. "Juan") > Clic en "Cerrar sesi贸n" > Clic en "S铆" > Verifica que vuelva a login.
- Inicia sesi贸n como usuario registrado > Clic en "Cerrar sesi贸n" > Clic en "S铆" > Verifica que vuelva a login.
- Si sigue sin funcionar, abre la consola (F12 > Console) y p谩same el mensaje de error.

Estoy aqu铆 para asegurarme de que esto funcione. Por favor, prueba y dime si ahora el bot贸n "S铆" cierra la sesi贸n correctamente para visitantes y usuarios. 
